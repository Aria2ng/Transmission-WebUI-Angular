{"version":3,"sources":["initConfig.js"],"names":["define","$","_","tr","angularAMD","app","angular","module","$app","bootstrap","factory","$http","$q","ajax","op","deferred","defer","method","url","baseUrl","undefined","headers","sessionId","X-Transmission-Session-Id","data","param","when","response","status","config","resolve","reject","errService","err","cancel","promise","service","getSession","getSessionStats","serviceAruments","all","torrentSame","detailSame","getTorrent","arguments","fields","concat","getActiveTorrent","ids","getFullDetail","getDetail","addTransform","params","startTorrent","stopTorrent","removeFromList","removeAllData","delete-local-data","pauseTransform","startTransform","startTransformNow","portTest","saveSettings","controller","$scope","$sce","$timeout","$window","$document","ajaxService","baseTmpUrl","tmpUrl","detail","blankDetail","tips","settings","modal","about","statics","addFiles","pool","loop","torrent","activeTorrent","session","sessionStats","fullDetail","remove","add","pause","dataStorage","globalOrignal","global","alt-speed-down","alt-speed-up","alt-speed-time-begin","alt-speed-time-end","alt-speed-time-day","selectedIndex","stats","port-test","searchText","name","totalSpeed","download","upload","speed-limit-times","start","min","parseTime","mins","str","hour","$mins","parseInt","i","push","key","value","speed-limit-day","encryption","metainfo","filename","download-dir","paused","loopFragment","active","sesseionErrCount","errStartTime","then","clone","reason","val","temp","indexOf","end","substring","length","$emit","Date","getTime","now","stopAllAjax","show","type","title","content","btnType","submitFunc","location","reload","loopGetSession","setInterval","getStatsData","init","downloadSpeed","uploadSpeed","activeErrCount","activeStartTime","getRecentlyActiveTorrentData","each","torrents","index","$index","findIndex","o","id","merge","getTotalSpeed","clearInterval","closeAjax","loopGetTorrentData","sortTorrentData","sortBy","item","addedDate","obj","allLoaded","addClass","setTimeout","removeClass","selectTorrent","close","swip","left","nav","getScreenWidth","consolePanel","right","up","$event","down","bytesConvert","bytes","band","parseFloat2","num","parsTorrentClassName","className","parseEta","eta","secondsToTime","getStatusText","metaComplete","howLong","getFullDate","ms","parseFullDate","parseText","Status","html","recheckProgress","peersSendingToUs","peersConnected","rateDownload","rateUpload","peersGettingFromUs","trustAsHtml","TransformData","metadataPercentComplete","totalSize","percentDone","uploadedEver","uploadRatio","target","tabNames","tabSelect","selectedTabIndex","torrentData","loopGetDetail","$response","dbshow","parseErrorText","error","errorString","setting","validationIDS","result","window","width","stopPropagation","size","tmp","element","arr","files","promiseFlag","errFlag","reader","FileReader","onload","e","contents","join","readAsDataURL","submitSettings","isNeedTitle","btnText","submit","selectTagContent","tag","swipLeft","swipRight","toggle","menudata","alt-speed-enabled","parseMenuVisible","localMode","require","localData","$on","event","document","addEventListener","cancelable","defaultPrevented","preventDefault","directive","restrict","link","scope","el","attrs","replaceWith","children"],"mappings":"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","file":"../initConfig.min.js","sourcesContent":["/**\r\n * Created by vincent on 2017/3/4.\r\n */\r\n\r\ndefine([\"jquery\", \"lodash\", \"transmission\", \"angularAMD\", \"mnTouch\"], function($, _, tr, angularAMD) {\r\n    \"use strict\";\r\n\r\n    var app = angular.module(\"transmission\", [\"mn\"]);\r\n\r\n    var $app = angularAMD.bootstrap(app);\r\n\r\n    $app.factory(\"ajaxService\", [\"$http\", \"$q\", function($http, $q) {\r\n        var service = {};\r\n        var baseUrl = \"/transmission/rpc\";\r\n\r\n        function ajax(op) {\r\n            var deferred = $q.defer();\r\n            var ajax = $http({\r\n                method: \"POST\",\r\n                url: baseUrl + (op.url !== undefined ? op.url : \"\"),\r\n                headers: op.sessionId !== undefined ? { \"X-Transmission-Session-Id\": op.sessionId } : {},\r\n                data: (function() {\r\n                    var param = {};\r\n                    switch (op.param.method) {\r\n                        case \"torrent-get\":\r\n                            param = op.param;\r\n                            break;\r\n                        case \"torrent-remove\":\r\n                            param = op.param;\r\n                            break;\r\n                        default:\r\n                            param = op.param;\r\n                            break;\r\n                    }\r\n                    return param;\r\n                })()\r\n            });\r\n\r\n            $q.when(ajax, function(response, status, headers, config) {\r\n                deferred.resolve(response, status, headers, config);\r\n            }, function(response, status) {\r\n                if (status !== 0) {\r\n                    deferred.reject({\r\n                        errService: op.errService ? op.errService : \"Service Error\",\r\n                        err: op.err,\r\n                        response: response,\r\n                        status: status\r\n                    });\r\n                }\r\n            });\r\n\r\n            return op.cancel === true ? deferred : deferred.promise;\r\n        }\r\n\r\n        service.getSession = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    method: \"session-get\"\r\n                },\r\n                url: \"?type=getSession\",\r\n                cancel: true\r\n            });\r\n        };\r\n\r\n        service.getSessionStats = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    method: \"session-stats\"\r\n                },\r\n                url: \"?type=getSessionStats\"\r\n            });\r\n        };\r\n\r\n        var serviceAruments = {\r\n            all:[\"id\"],\r\n            torrentSame: [\"error\", \"errorString\", \"eta\", \"isFinished\", \"isStalled\", \"leftUntilDone\", \"metadataPercentComplete\", \"peersConnected\", \"peersGettingFromUs\", \"peersSendingToUs\", \"percentDone\", \"queuePosition\", \"rateDownload\", \"rateUpload\", \"recheckProgress\", \"seedRatioMode\", \"seedRatioLimit\", \"sizeWhenDone\", \"status\", \"trackers\", \"downloadDir\", \"uploadedEver\", \"uploadRatio\", \"webseedsSendingToUs\"],\r\n            detailSame:[\"activityDate\",\"corruptEver\",\"desiredAvailable\",\"downloadedEver\",\"fileStats\",\"haveUnchecked\",\"haveValid\",\"peers\",\"startDate\",\"trackerStats\"]\r\n        };\r\n\r\n        service.getTorrent = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    method: \"torrent-get\",\r\n                    arguments: {\r\n                        \"fields\": _.concat(serviceAruments.all,serviceAruments.torrentSame,[\r\n                            \"addedDate\",\r\n                            \"name\",\r\n                            \"totalSize\"\r\n                        ])\r\n                    }\r\n                },\r\n                url: \"?type=getTorrent\",\r\n                cancel: true\r\n            });\r\n        };\r\n\r\n        service.getActiveTorrent = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    method: \"torrent-get\",\r\n                    arguments: {\r\n                        fields: _.concat(serviceAruments.all,serviceAruments.torrentSame),\r\n                        ids: \"recently-active\"\r\n                    }\r\n                },\r\n                url: \"?type=getActiveTorrent\",\r\n                cancel: true\r\n            });\r\n        };\r\n\r\n        service.getFullDetail = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-get\",\r\n                    \"arguments\": {\r\n                        \"fields\": _.concat(serviceAruments.all,serviceAruments.detailSame,[\r\n                            \"comment\",\r\n                            \"creator\",\r\n                            \"dateCreated\",\r\n                            \"files\",\r\n                            \"hashString\",\r\n                            \"isPrivate\",\r\n                            \"pieceCount\",\r\n                            \"pieceSize\"\r\n                        ]),\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=getFullDetail\",\r\n                cancel: true\r\n            });\r\n        };\r\n\r\n        service.getDetail = function(sessionId, ids) {\r\n            return ajax({\r\n                \"sessionId\": sessionId,\r\n                \"param\": {\r\n                    \"method\": \"torrent-get\",\r\n                    \"arguments\": {\r\n                        \"fields\": _.concat(serviceAruments.all,serviceAruments.detailSame),\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                \"url\": \"?type=getDetail\",\r\n                \"cancel\": true\r\n            });\r\n        };\r\n\r\n        service.addTransform = function(sessionId,params) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-add\",\r\n                    \"arguments\":params\r\n                },\r\n                url: \"?type=torrent-add\"\r\n            });\r\n        };\r\n\r\n        service.startTorrent = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-start\"\r\n                },\r\n                url: \"?type=startTorrent\"\r\n            });\r\n        };\r\n\r\n        service.stopTorrent = function(sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    method: \"torrent-stop\"\r\n                },\r\n                url: \"?type=stopTorrent\"\r\n            });\r\n        };\r\n\r\n        service.removeFromList = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-remove\",\r\n                    \"arguments\": {\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=removeFromList\"\r\n            });\r\n        };\r\n\r\n        service.removeAllData = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-remove\",\r\n                    \"arguments\": {\r\n                        \"delete-local-data\": true,\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=removeAllData\"\r\n            });\r\n        };\r\n\r\n        service.pauseTransform = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-stop\",\r\n                    \"arguments\": {\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=torrent-stop\"\r\n            });\r\n        };\r\n\r\n        service.startTransform = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-start\",\r\n                    \"arguments\": {\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=torrent-start\"\r\n            });\r\n        };\r\n\r\n        service.startTransformNow = function(sessionId, ids) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"torrent-start-now\",\r\n                    \"arguments\": {\r\n                        \"ids\": ids\r\n                    }\r\n                },\r\n                url: \"?type=torrent-start-now\"\r\n            });\r\n        };\r\n\r\n        service.portTest = function (sessionId) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"port-test\"\r\n                },\r\n                url: \"?type=port-test\"\r\n            });\r\n        };\r\n\r\n        service.saveSettings = function (sessionId,params) {\r\n            return ajax({\r\n                sessionId: sessionId,\r\n                param: {\r\n                    \"method\": \"session-set\",\r\n                    \"arguments\": params\r\n                },\r\n                url: \"?type=saveSettings\"\r\n            });\r\n        };\r\n        return service;\r\n    }]);\r\n\r\n    $app.controller(\"mainController\", [\"$scope\", \"$http\", \"$q\", \"$sce\", \"$timeout\", \"$window\", \"$document\", \"ajaxService\", function($scope, $http, $q, $sce, $timeout, $window, $document, ajaxService) {\r\n\r\n        var baseTmpUrl = \"template/\";\r\n        $scope.tmpUrl = {\r\n            detail: baseTmpUrl + \"detail.html\",\r\n            blankDetail: baseTmpUrl + \"blankDetail.html\",\r\n            tips: baseTmpUrl + \"modal.html\",\r\n            settings: baseTmpUrl + \"settings.html\",\r\n            modal:baseTmpUrl + \"modal.html\",\r\n            about:baseTmpUrl + \"about.html\",\r\n            statics:baseTmpUrl + \"statics.html\",\r\n            addFiles:baseTmpUrl + \"addFiles.html\"\r\n        };\r\n\r\n        //loop pool\r\n        $scope.pool = {\r\n            \"loop\": {\r\n                \"torrent\": 0,\r\n                \"activeTorrent\": 0,\r\n                \"session\": 0,\r\n                \"sessionStats\":0,\r\n                \"detail\": 0\r\n            },\r\n            \"ajax\": {\r\n                \"torrent\": {},\r\n                \"activeTorrent\": {},\r\n                \"detail\": {},\r\n                \"fullDetail\": {},\r\n                \"sessionStats\":{},\r\n                \"session\":{},\r\n                \"remove\":{},\r\n                \"add\":{},\r\n                \"pause\":{}\r\n            }\r\n        };\r\n\r\n        //数据\r\n        $scope.dataStorage = {\r\n            \"session\": \"\",\r\n            \"globalOrignal\":{},\r\n            \"global\": {\r\n                \"alt-speed-down\":0,\r\n                \"alt-speed-up\":0,\r\n                \"alt-speed-time-begin\":0,\r\n                \"alt-speed-time-end\":0,\r\n                \"alt-speed-time-day\":127\r\n                // \"encryption\":\"tolerated\"\r\n                // \"seedRatioLimited\":false,\r\n                // \"idle-seeding-limit-enabled\":false,\r\n                // \"speed-limit-up-enabled\":false,\r\n                // \"speed-limit-down-enabled\":false,\r\n                // \"alt-speed-time-enabled\":false,\r\n                // \"blocklist-enabled\":false\r\n            },\r\n            \"torrent\": [],\r\n            \"selectedIndex\": \"\",\r\n            \"stats\": {},\r\n            \"ids\": [],\r\n            \"detail\": {},\r\n            \"port-test\":false,\r\n            \"searchText\":{\r\n                name:\"\"\r\n            },\r\n            \"totalSpeed\":{\r\n                download:0,\r\n                upload:0\r\n            },\r\n            \"speed-limit-times\":(function () {\r\n                var start = [];\r\n                var min = 0;\r\n                var parseTime = function (mins) {\r\n                    var str = \"\";\r\n                    var hour = 0;\r\n                    var $mins = 0;\r\n\r\n                    if (mins < 60) {\r\n                        str = \"00:\" + (mins < 10 ? \"0\" + mins : mins);\r\n                    } else {\r\n                        hour = parseInt(mins / 60);\r\n                        $mins = mins - (hour * 60);\r\n                        str = (hour < 10 ? \"0\" + hour : hour) + \":\" + ($mins === 0 ? \"00\" : $mins);\r\n                    }\r\n\r\n                    return str;\r\n                };\r\n                for (var i = 0; i < 96; i++) {\r\n                    start.push({key:parseTime(min),value:min});\r\n                    min += 15;\r\n                }\r\n                return start;\r\n            })(),\r\n            \"speed-limit-day\":[\r\n                {\"key\":\"每天\",\"value\":127},\r\n                {\"key\":\"工作日\",\"value\":62},\r\n                {\"key\":\"周末\",\"value\":65},\r\n                {\"key\":\"星期天\",\"value\":1},\r\n                {\"key\":\"星期一\",\"value\":2},\r\n                {\"key\":\"星期二\",\"value\":4},\r\n                {\"key\":\"星期三\",\"value\":8},\r\n                {\"key\":\"星期四\",\"value\":16},\r\n                {\"key\":\"星期五\",\"value\":32},\r\n                {\"key\":\"星期六\",\"value\":64}\r\n            ],\r\n            \"encryption\":[\r\n                {\"key\":\"允许加密\",\"value\":\"tolerated\"},\r\n                {\"key\":\"喜欢加密\",\"value\":\"preferred\"},\r\n                {\"key\":\"需要加密\",\"value\":\"required\"}\r\n            ],\r\n            \"addTransform\":{\r\n                \"metainfo\":[],\r\n                \"filename\":\"\",\r\n                \"download-dir\":\"123123\",\r\n                \"paused\":true\r\n            }\r\n        };\r\n\r\n        $scope.loopFragment = {\r\n            torrent: 5000,\r\n            active: 5000,\r\n            detail: 5000,\r\n            session: 30000\r\n        };\r\n\r\n        //获取session\r\n        var sesseionErrCount = 0;\r\n        var errStartTime = \"\";\r\n        $scope.getSession = function(session) {\r\n\r\n            //获取session\r\n            $scope.pool.ajax.session = ajaxService.getSession(session);\r\n            $scope.pool.ajax.session.promise.then(function(response) {\r\n                sesseionErrCount = 0;\r\n                $scope.dataStorage.global = response.data.arguments;\r\n                $scope.dataStorage.globalOrignal = _.clone(response.data.arguments);\r\n            }, function(reason) {\r\n                var val = true;\r\n                var str = reason.response.data;\r\n                if(str === null){\r\n                    val = false;\r\n                }\r\n\r\n                if(val === true){\r\n                    var temp = \"X-Transmission-Session-Id: \";\r\n                    var start = str.indexOf(temp);\r\n                    var end = str.indexOf(\"<\\/code>\");\r\n                    if(start !== -1 && end !== -1){\r\n                        $scope.dataStorage.session = str.substring((start + (temp.length - 1)), end);\r\n                        $scope.$emit(\"getSessionDone\");\r\n                    }else{\r\n                        val = false;\r\n                    }\r\n                }\r\n\r\n                if(val === false){\r\n                    //1分钟内连续错误5次则直接停止所有异步请求，并提示\r\n                    sesseionErrCount += 1;\r\n                    if(sesseionErrCount === 1){\r\n                        errStartTime = new Date().getTime();\r\n                    }else if(sesseionErrCount >= 5){\r\n                        var now = new Date().getTime();\r\n                        if((now - errStartTime) <= 180000){\r\n                            $scope.stopAllAjax();\r\n                            $scope.modal.show({\r\n                                type:\"waring\",\r\n                                title:\"一分钟内请求Session失败次数过多\",\r\n                                content:\"请检查您的网络是否顺畅，或点击确定通过刷新尝试解决！\",\r\n                                btnType : 2,\r\n                                submitFunc : function () {\r\n                                    $window.location.reload();\r\n                                }\r\n                            });\r\n                        }else{\r\n                            sesseionErrCount = 0;\r\n                            errStartTime = new Date().getTime();\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        //循环获取session数据\r\n        $scope.loopGetSession = function() {\r\n            $scope.getSession($scope.dataStorage.session);\r\n            $scope.pool.loop.session = setInterval(function() {\r\n                $scope.getSession($scope.dataStorage.session);\r\n            }, $scope.loopFragment.session);\r\n        };\r\n\r\n        //获取统计信息\r\n        $scope.getStatsData = function(init) {\r\n            //获取session\r\n            $scope.pool.ajax.sessionStats = ajaxService.getSessionStats($scope.dataStorage.session).then(function(response) {\r\n                $scope.dataStorage.stats = response.data.arguments;\r\n                if(init === \"init\"){\r\n                    $scope.dataStorage.totalSpeed.download = $scope.dataStorage.stats.downloadSpeed;\r\n                    $scope.dataStorage.totalSpeed.upload = $scope.dataStorage.stats.uploadSpeed;\r\n                    $scope.$emit(\"getStatsDone\");\r\n                }\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"查询统计数据失败\",\r\n                    content:\"请检查您的网络是否顺畅，或点击确定重新加载一次！\",\r\n                    btnType : 2,\r\n                    submitFunc : function () {\r\n                        $scope.getStatsData();\r\n                    }\r\n                });\r\n            });\r\n        };\r\n\r\n        //获取正在活动的Torrent数据\r\n        var activeErrCount = 0;\r\n        var activeStartTime = 0;\r\n        $scope.getRecentlyActiveTorrentData = function() {\r\n            //获取活动中的torrent数据\r\n            $scope.pool.ajax.activeTorrent = ajaxService.getActiveTorrent($scope.dataStorage.session);\r\n            $scope.pool.ajax.activeTorrent.promise.then(function(response) {\r\n                activeErrCount = 0;\r\n                //替换数据列表中对应的数据\r\n                _.each(response.data.arguments.torrents, function(value, index) {\r\n                    var $index = _.findIndex($scope.dataStorage.torrent, function(o) {\r\n                        return o.id === value.id;\r\n                    });\r\n\r\n                    if ($index > -1) {\r\n                        _.merge($scope.dataStorage.torrent[$index], value);\r\n                    }\r\n                });\r\n                $scope.getTotalSpeed();\r\n            }, function(reason) {\r\n                activeErrCount += 1;\r\n                if(activeErrCount === 1){\r\n                    activeStartTime = new Date().getTime();\r\n                }else if(sesseionErrCount >= 5){\r\n                    var now = new Date().getTime();\r\n                    if((now - activeStartTime) <= 60000){\r\n                        clearInterval($scope.pool.loop.activeTorrent);\r\n                        $scope.closeAjax($scope.pool.ajax.torrent);\r\n                        $scope.modal.show({\r\n                            type:\"waring\",\r\n                            title:\"短期内多次查询活动任务失败\",\r\n                            content:\"请检查您的网络是否顺畅，或点击确定通过刷新尝试解决！\",\r\n                            btnType : 2,\r\n                            submitFunc : function () {\r\n                                $scope.loopGetTorrentData();\r\n                            }\r\n                        });\r\n                    }else{\r\n                        activeErrCount = 0;\r\n                        activeStartTime = new Date().getTime();\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        //排序种子数据\r\n        $scope.sortTorrentData = function() {\r\n            $scope.dataStorage.torrent = _.sortBy($scope.dataStorage.torrent, function(item) {\r\n                return -item.addedDate;\r\n            });\r\n            $scope.getTotalSpeed();\r\n            return $scope.dataStorage.torrent;\r\n        };\r\n\r\n        //循环获取种子数据\r\n        $scope.loopGetTorrentData = function() {\r\n            //get all torrent(list)\r\n            $scope.pool.ajax.torrent = ajaxService.getTorrent($scope.dataStorage.session);\r\n            $scope.pool.ajax.torrent.promise.then(function(response) {\r\n                $scope.dataStorage.torrent = _.sortBy(response.data.arguments.torrents, function(item) {\r\n                    return -item.addedDate;\r\n                });\r\n\r\n                $scope.dataStorage.ids = [];\r\n                _.each($scope.dataStorage.torrent, function(obj, index) {\r\n                    $scope.dataStorage.ids.push(obj.id);\r\n                });\r\n\r\n                $scope.allLoaded = true;\r\n                $(\"#loading\").addClass(\"loading-hide\");\r\n                setTimeout(function () {\r\n                    $(\"#loading\").remove();\r\n                },1000);\r\n\r\n                $(\".hide\").removeClass(\"hide\");\r\n\r\n                //loop the active torrent\r\n                $scope.pool.ajax.activeTorrent = $scope.getRecentlyActiveTorrentData();\r\n                $scope.pool.loop.activeTorrent = setInterval(function() {\r\n                    $scope.getRecentlyActiveTorrentData();\r\n                }, $scope.loopFragment.torrent);\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"获取传输任务列表数据失败\",\r\n                    content:\"请检查您的网络是否顺畅，或点击确定重新加载一次！\",\r\n                    btnType : 2,\r\n                    submitFunc : function () {\r\n                        $scope.loopGetTorrentData();\r\n                    }\r\n                });\r\n            });\r\n        };\r\n\r\n        //选择某下载任务\r\n        $scope.selectTorrent = function(index) {\r\n            if (index === $scope.dataStorage.selectedIndex) {\r\n                return false;\r\n            }\r\n            $scope.dataStorage.selectedIndex = index;\r\n            if ($scope.detail.status === true) {\r\n                $scope.detail.close();\r\n                $scope.detail.show();\r\n            }\r\n        };\r\n\r\n        //滑动操作\r\n        $scope.swip = {\r\n            left: function() {\r\n\r\n                if($scope.modal.status === true){\r\n                    return false;\r\n                }\r\n\r\n                if($scope.nav.status === true){\r\n                    $scope.nav.close();\r\n                }\r\n\r\n                if ($scope.getScreenWidth() <= 1024) {\r\n                    if ($scope.consolePanel.status === false && $scope.detail.status === false) {\r\n                        $scope.detail.show();\r\n                    } else if ($scope.consolePanel.status === true && $scope.detail.status === false) {\r\n                        $scope.consolePanel.close();\r\n                    }\r\n                }\r\n            },\r\n            right: function() {\r\n\r\n                if($scope.modal.status === true){\r\n                    return false;\r\n                }\r\n\r\n                if($scope.nav.status === true){\r\n                    $scope.nav.close();\r\n                }\r\n\r\n                if ($scope.getScreenWidth() <= 1024) {\r\n                    if ($scope.consolePanel.status === false && $scope.detail.status === true) {\r\n                        $scope.detail.close();\r\n                    } else if ($scope.consolePanel.status === false && $scope.detail.status === false) {\r\n                        $scope.consolePanel.show();\r\n                    }\r\n                }\r\n            },\r\n            up:function ($event) {\r\n                if($scope.modal.status === true || $scope.consolePanel.status === true || $scope.detail.status === true){\r\n                    return false;\r\n                }else{\r\n                    $scope.nav.close($event);\r\n                }\r\n            },\r\n            down:function () {\r\n                if($scope.modal.status === true || $scope.consolePanel.status === true || $scope.detail.status === true){\r\n                    return false;\r\n                }else{\r\n                    $scope.nav.show();\r\n                }\r\n            }\r\n        };\r\n\r\n        //流量转换\r\n        $scope.bytesConvert = function(bytes) {\r\n            var op = {\r\n                \"data\": bytes,\r\n                \"band\": 1000\r\n            };\r\n            return tr.bytesConvert(op);\r\n        };\r\n\r\n        //分析已下载数据\r\n        $scope.parseFloat2 = function(num) {\r\n            return tr.parseFloat2(num);\r\n        };\r\n\r\n        //解析下载任务的样式名\r\n        $scope.parsTorrentClassName = function(status, index) {\r\n            var className = \"\";\r\n            //4正在下载\r\n            switch (status) {\r\n                case 0:\r\n                    className = \"paused\";\r\n                    break;\r\n                case 2:\r\n                    className = \"rechecking\";\r\n                    break;\r\n                case 4:\r\n                    className = \"downloading\";\r\n                    break;\r\n                case 6:\r\n                    className = \"seeding\";\r\n                    break;\r\n                default:\r\n                    className = \"seeding\";\r\n                    break;\r\n            }\r\n            if (index === $scope.dataStorage.selectedIndex) {\r\n                className += \" selected\";\r\n            }\r\n            return className;\r\n        };\r\n\r\n        //解析剩余时间\r\n        $scope.parseEta = function(eta) {\r\n            var str = \"\";\r\n            if (eta === -1) {\r\n                str = \"不可用\";\r\n            } else if (eta === -2) {\r\n                str = \"无法预估\";\r\n            } else {\r\n                str = tr.secondsToTime(eta);\r\n            }\r\n\r\n            return str;\r\n        };\r\n\r\n        $scope.parseFloat2 = function(num) {\r\n            return tr.parseFloat2(num);\r\n        };\r\n\r\n        //获取状态文本\r\n        $scope.getStatusText = function(op) {\r\n            var str = \"\";\r\n            switch (op.status) {\r\n                case 0:\r\n                    if (op.metaComplete < 1) {\r\n                        str = \"磁性链接下载元数据中\";\r\n                    } else {\r\n                        str = \"已暂停\";\r\n                    }\r\n                    break;\r\n                case 4:\r\n                    str = \"下载中\";\r\n                    break;\r\n                case 6:\r\n                    str = \"做种中\";\r\n                    break;\r\n            }\r\n\r\n            return str;\r\n        };\r\n\r\n        //获取运行时长\r\n        $scope.howLong = function(start) {\r\n            return $scope.parseEta(parseInt((new Date().getTime()) / 1000) - start);\r\n        };\r\n\r\n        $scope.getFullDate = function(ms) {\r\n            return tr.parseFullDate(ms);\r\n        };\r\n\r\n        //解析torrent列表文字\r\n        $scope.parseText = {\r\n            \"Status\": function(index) {\r\n                var data = $scope.dataStorage.torrent[index];\r\n                var html = \"\";\r\n\r\n                switch (data.status) {\r\n                    case 0:\r\n                        // className = \"paused\";\r\n                        html += \"已暂停\";\r\n                        break;\r\n                    case 1:\r\n                        //磁性链接\r\n                        // className = \"valMetaData\";\r\n                        // html += \"已暂停\";\r\n                        break;\r\n                    case 2:\r\n                        html += \"正在验证本底数据\";\r\n                        html += \"<span>(\" + (data.recheckProgress < 1 ? tr.parseFloat2(data.recheckProgress * 100) : \"100\") + \"% 已验证)</span>\";\r\n                        break;\r\n                    case 4:\r\n                        html += \"下载自\";\r\n                        html += \"<span>\" + data.peersSendingToUs + \"/\" + data.peersConnected + \"个用户</span>\";\r\n                        html += \"<span class=\\\"icon-download\\\">\";\r\n                        html += $scope.bytesConvert(data.rateDownload) + \"/s\";\r\n                        html += \"</span>\";\r\n                        html += \"<span class=\\\"icon-upload\\\">\";\r\n                        html += $scope.bytesConvert(data.rateUpload) + \"/s\";\r\n                        html += \"</span>\";\r\n                        break;\r\n                    case 6:\r\n                        html += \"分享至\";\r\n                        html += \"<span>\" + data.peersGettingFromUs + \"/\" + data.peersConnected + \"个用户</span>\";\r\n                        html += \"<span class=\\\"icon-upload\\\">\";\r\n                        html += $scope.bytesConvert(data.rateUpload) + \"/s\";\r\n                        html += \"</span>\";\r\n                        break;\r\n                    default:\r\n                        // className = \"seeding\";\r\n                        break;\r\n                }\r\n\r\n                return $sce.trustAsHtml(html);\r\n            },\r\n            \"TransformData\": function(index) {\r\n                var data = $scope.dataStorage.torrent[index];\r\n                var html = \"\";\r\n\r\n                switch (data.status) {\r\n                    case 0:\r\n                        // className = \"paused\";\r\n                        if (data.metadataPercentComplete < 1) {\r\n                            html += \"磁性链接\";\r\n                            html += \"<span>\";\r\n                            html += \"下载元数据（\" + (data.metadataPercentComplete < 1 ? tr.parseFloat2(data.metadataPercentComplete * 100) : \"100\") + \"%）\";\r\n                            html += \"</span>\";\r\n                        } else {\r\n                            html += \"<span>\";\r\n                            html += $scope.bytesConvert(data.totalSize * (data.percentDone < 1 ? data.percentDone : 1)) + \"/\" + $scope.bytesConvert(data.totalSize);\r\n                            html += \"</span>\";\r\n                            html += \"<span>\";\r\n                            html += \"(\" + (data.percentDone < 1 ? tr.parseFloat2(data.percentDone * 100) : \"100\") + \"%)\";\r\n                            html += \"</span>\";\r\n                        }\r\n                        break;\r\n                    case 2:\r\n                        html += \"已下载\";\r\n                        html += \"<span>\";\r\n                        html += $scope.bytesConvert(data.totalSize * (data.percentDone < 1 ? data.percentDone : 1)) + \"/\" + $scope.bytesConvert(data.totalSize);\r\n                        html += \"</span>\";\r\n                        html += \"<span>\";\r\n                        html += \"(\" + (data.percentDone < 1 ? tr.parseFloat2(data.percentDone * 100) : \"100\") + \"%)\";\r\n                        html += \"</span>\";\r\n                        if (data.uploadedEver > 0) {\r\n                            html += \"<span>\";\r\n                            html += \"已上传\";\r\n                            html += \"</span>\";\r\n                            html += \"<span>\";\r\n                            html += $scope.bytesConvert(data.uploadedEver);\r\n                            html += \"</span>\";\r\n                        }\r\n                        if ($scope.getScreenWidth() > 1024) {\r\n                            html += \"<span>\";\r\n                            html += \"预估剩余时间：\" + $scope.parseEta(data.eta);\r\n                            html += \"</span>\";\r\n                        }\r\n                        break;\r\n                    case 4:\r\n                        // className = \"downloading\";,\r\n                        if (data.metadataPercentComplete < 1) {\r\n                            html += \"磁性链接<span> 下载元数据（\" + (data.metadataPercentComplete < 1 ? tr.parseFloat2(data.metadataPercentComplete * 100) : \"100\") + \"）</span>\";\r\n                        } else {\r\n                            html += \"已下载\";\r\n                            html += \"<span>\";\r\n                            html += $scope.bytesConvert(data.totalSize * (data.percentDone < 1 ? data.percentDone : 1)) + \"/\" + $scope.bytesConvert(data.totalSize);\r\n                            html += \"</span>\";\r\n                            html += \"<span>\";\r\n                            html += \"(\" + (data.percentDone < 1 ? tr.parseFloat2(data.percentDone * 100) : \"100\") + \"%)\";\r\n                            html += \"</span>\";\r\n                            if (data.uploadedEver > 0) {\r\n                                html += \"<span>\";\r\n                                html += \"已上传\";\r\n                                html += \"</span>\";\r\n                                html += \"<span>\";\r\n                                html += $scope.bytesConvert(data.uploadedEver);\r\n                                html += \"</span>\";\r\n                            }\r\n                            if ($scope.getScreenWidth() > 1024) {\r\n                                html += \"<span>\";\r\n                                html += \"预估剩余时间：\" + $scope.parseEta(data.eta);\r\n                                html += \"</span>\";\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 6:\r\n                        // className = \"seeding\";\r\n                        html += \"已上传\";\r\n                        html += \"<span>\";\r\n                        html += $scope.bytesConvert(data.uploadedEver) + \"/\" + $scope.bytesConvert(data.totalSize);\r\n                        html += \"</span>\";\r\n                        html += \"<span>\";\r\n                        html += \"分享率(\" + tr.parseFloat2(data.uploadRatio) + \"%)\";\r\n                        html += \"</span>\";\r\n                        if ($scope.getScreenWidth() > 1024) {\r\n                            html += \"<span>\";\r\n                            html += \"预估剩余时间：\" + $scope.parseEta(data.eta);\r\n                            html += \"</span>\";\r\n                        }\r\n                        break;\r\n                    default:\r\n                        // className = \"seeding\";\r\n                        break;\r\n                }\r\n\r\n                return $sce.trustAsHtml(html);\r\n            }\r\n        };\r\n\r\n        //明细\r\n        $scope.detail = {\r\n            \"target\": $(\"#torrent-detail\"),\r\n            \"className\": \"show\",\r\n            \"tabNames\": [\"info\", \"peers\", \"tracker\", \"files\"],\r\n            \"tabSelect\": function(index) {\r\n                $scope.detail.selectedTabIndex = index;\r\n            },\r\n            \"status\": false,\r\n            \"torrentData\": false,\r\n            \"selectedTabIndex\": 0,\r\n            \"loopGetDetail\":function () {\r\n                $scope.pool.ajax.fullDetail = ajaxService.getFullDetail($scope.dataStorage.session, [$scope.dataStorage.torrent[$scope.dataStorage.selectedIndex].id]);\r\n                $scope.pool.ajax.fullDetail.promise.then(function(response) {\r\n                    $scope.dataStorage.detail = response.data.arguments.torrents[0];\r\n                    $scope.pool.loop.detail = setInterval(function() {\r\n                        $scope.pool.ajax.detail = ajaxService.getDetail($scope.dataStorage.session, [$scope.dataStorage.torrent[$scope.dataStorage.selectedIndex].id]);\r\n                        $scope.pool.ajax.detail.promise.then(function($response) {\r\n                            $scope.dataStorage.detail = _.merge($scope.dataStorage.detail, $response.data.arguments.torrents[0]);\r\n                        }, function(reason) {\r\n                            clearInterval($scope.pool.loop.detail);\r\n                            $scope.closeAjax($scope.pool.ajax.fullDetail);\r\n                            $scope.closeAjax($scope.pool.ajax.detail);\r\n                            $scope.modal.show({\r\n                                type:\"waring\",\r\n                                title:\"维护明细数据失败\",\r\n                                content:\"请检查您的网络是否顺畅，或点击确定通过刷新尝试解决！\",\r\n                                btnType : 2,\r\n                                submitFunc : function () {\r\n                                    $scope.detail.loopGetDetail();\r\n                                }\r\n                            });\r\n                        });\r\n                    }, $scope.loopFragment.detail);\r\n                }, function(reason) {\r\n                    $scope.modal.show({\r\n                        type:\"waring\",\r\n                        title:\"获取明细数据失败\",\r\n                        content:\"请检查您的网络是否顺畅！\",\r\n                        btnType : 1\r\n                    });\r\n                });\r\n            },\r\n            \"show\": function() {\r\n                $scope.detail.status = $scope.detail.status !== true;\r\n\r\n                if ($scope.detail.status === true) {\r\n                    if ($scope.dataStorage.selectedIndex !== '') {\r\n                        $scope.detail.torrentData = $scope.dataStorage.torrent[$scope.dataStorage.selectedIndex];\r\n                        $scope.detail.loopGetDetail();\r\n                    }\r\n                } else {\r\n                    $scope.detail.close();\r\n                }\r\n            },\r\n            \"dbshow\":function ($event,index) {\r\n                if($scope.getScreenWidth() > 1024){\r\n                    $scope.nav.close();\r\n                    $scope.detail.show();\r\n                }\r\n            },\r\n            \"close\": function() {\r\n                $scope.detail.status = false;\r\n                clearInterval($scope.pool.loop.detail);\r\n                $scope.closeAjax($scope.pool.ajax.fullDetail);\r\n                $scope.closeAjax($scope.pool.ajax.detail);\r\n            },\r\n            \"parseErrorText\":function () {\r\n                var str = \"\";\r\n                switch ($scope.detail.torrentData.error){\r\n                    case 0:\r\n                        str = \"无错误\";\r\n                        break;\r\n                    case 1:\r\n                        str = \"Tracker服务器告警\";\r\n                        break;\r\n                    case 2:\r\n                        str = \"Tracker服务器错误\";\r\n                        break;\r\n                    case 3:\r\n                        str = \"本地错误\";\r\n                        break;\r\n                    default:\r\n                        str = $scope.detail.torrentData.errorString;\r\n                        break;\r\n                }\r\n\r\n                return str;\r\n            }\r\n        };\r\n\r\n        $scope.setting = {\r\n            show:function () {\r\n                $scope.modal.show({\r\n                    type:\"window\",\r\n                    btnType : 2,\r\n                    submitFunc : function () {\r\n                        $window.location.reload();\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        $scope.closeAjax = function(obj) {\r\n            if (typeof obj === \"object\" && typeof obj.resolve === \"function\") {\r\n                obj.resolve();\r\n            }\r\n        };\r\n\r\n        $scope.reload = {\r\n            \"session\":function () {\r\n                clearInterval($scope.pool.loop.session);\r\n                $scope.closeAjax($scope.pool.ajax.session);\r\n                $scope.closeAjax($scope.pool.ajax.sessionStats);\r\n                $scope.loopGetSession();\r\n            },\r\n            \"torrent\": function() {\r\n                clearInterval($scope.pool.loop.activeTorrent);\r\n                $scope.closeAjax($scope.pool.ajax.torrent);\r\n                $scope.closeAjax($scope.pool.ajax.activeTorrent);\r\n                $scope.loopGetTorrentData();\r\n            },\r\n            \"detail\": function() {\r\n                clearInterval($scope.pool.loop.detail);\r\n                $scope.closeAjax($scope.pool.ajax.fullDetail);\r\n                $scope.closeAjax($scope.pool.ajax.detail);\r\n                $scope.detail.loopGetDetail();\r\n            }\r\n        };\r\n\r\n        var validationIDS = function(ids) {\r\n            var result = true;\r\n            if ($scope.dataStorage.torrent.length === 0 || ids === undefined || ids.length === 0 || (ids.length === 1 && ids[0] === undefined)) {\r\n                result = false;\r\n            }\r\n\r\n            if ($(window).width() <= 1024) {\r\n                $scope.consolePanel.status = false;\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        $scope.addTransform = function ($event) {\r\n            $scope.dataStorage.addTransform.paused = true;\r\n            $scope.dataStorage.addTransform['download-dir'] = $scope.dataStorage.global['download-dir'];\r\n            $event.stopPropagation();\r\n            $scope.modal.show({\r\n                type:\"add\",\r\n                size:\"big\",\r\n                title:\"添加任务\",\r\n                tmp:$scope.tmpUrl.addFiles,\r\n                submitFunc:function () {\r\n                    $scope.modal.close();\r\n                    var filename = angular.element(\"#addTorrentUrl\")[0].value;\r\n                    if(filename !== \"\" && filename !== undefined && filename !== null){\r\n                        var params = {\r\n                            'paused': $scope.dataStorage.addTransform.paused,\r\n                            'download-dir': $scope.dataStorage.addTransform['download-dir'],\r\n                            'filename': filename\r\n                        };\r\n\r\n                        ajaxService.addTransform($scope.dataStorage.session,params).then(function () {\r\n                            $scope.reload.torrent();\r\n                            $scope.reload.session();\r\n                        },function (reason) {\r\n                            $scope.modal.show({\r\n                                type:\"waring\",\r\n                                title:\"任务添加失败\",\r\n                                content:value.name + reason.data.result,\r\n                                size:\"small\",\r\n                                btnType : 1\r\n                            });\r\n                        });\r\n                    }else{\r\n                        var arr = [];\r\n                        var files = angular.element(\"#addTorrentFiles\")[0].files;\r\n                        var err = [];\r\n                        var promiseFlag = false;\r\n                        var errFlag = false;\r\n                        _.each(files,function (value, $index) {\r\n                            var reader = new FileReader();\r\n                            reader.onload = function(e) {\r\n                                var contents = e.target.result;\r\n                                var key = \"base64,\";\r\n                                var index = contents.indexOf (key);\r\n                                if (index > -1) {\r\n                                    var metainfo = contents.substring (index + key.length);\r\n                                    var params = {\r\n                                        'paused': $scope.dataStorage.addTransform.paused,\r\n                                        'download-dir': $scope.dataStorage.addTransform['download-dir'],\r\n                                        'metainfo': metainfo\r\n                                    };\r\n\r\n                                    arr[$index] = ajaxService.addTransform($scope.dataStorage.session,params).then(function () {\r\n                                        if(arr.length === files.length && promiseFlag === false){\r\n                                            setTimeout(function () {\r\n                                                $scope.reload.torrent();\r\n                                                $scope.reload.session();\r\n                                            },3000);\r\n                                            promiseFlag = true;\r\n                                        }\r\n                                    },function (reason) {\r\n                                        if(arr.length === files.length && errFlag === false){\r\n                                            errFlag = true;\r\n                                            $scope.modal.show({\r\n                                                type:\"waring\",\r\n                                                title:\"任务添加失败\",\r\n                                                content:err.join(\";\"),\r\n                                                size:\"small\",\r\n                                                btnType : 1\r\n                                            });\r\n                                        }else{\r\n                                            err[$index] = value.name + reason.data.result;\r\n                                        }\r\n                                    });\r\n                                }\r\n                            };\r\n                            reader.readAsDataURL (value);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        $scope.removeFromList = function(ids) {\r\n            if (validationIDS(ids) === false) {\r\n                return false;\r\n            }\r\n            // $scope.dataStorage.session\r\n            $scope.modal.show({\r\n                type:\"waring\",\r\n                title:\"确定要从传输任务列表中删除\"+ (ids.length > 1?\"这些\":\"此\") +\"任务吗？\",\r\n                content:ids.length > 1?\"已选中多个任务\":$scope.dataStorage.torrent[$scope.dataStorage.selectedIndex].name,\r\n                btnType : 2,\r\n                submitFunc:function () {\r\n                    $scope.modal.close();\r\n                    ajaxService.removeFromList($scope.dataStorage.session, ids).then(function(response) {\r\n                        $scope.reload.torrent();\r\n                    }, function(reason) {\r\n                        $scope.modal.show({\r\n                            type:\"waring\",\r\n                            title:\"从下载列表中移除任务失败\",\r\n                            content:\"请检查您的网络是否顺畅！\",\r\n                            btnType : 1\r\n                        });\r\n                    });\r\n                }\r\n            });\r\n        };\r\n\r\n        $scope.pauseTransform = function(ids) {\r\n            if (validationIDS(ids) === false) {\r\n                return false;\r\n            }\r\n            ajaxService.pauseTransform($scope.dataStorage.session, ids).then(function(response) {\r\n                $scope.reload.torrent();\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"暂停传输任务请求失败！\",\r\n                    content:\"请检查您的网络是否顺畅！\",\r\n                    btnType : 1\r\n                });\r\n            });\r\n        };\r\n\r\n        $scope.startTransform = function(ids) {\r\n            if (validationIDS(ids) === false) {\r\n                return false;\r\n            }\r\n            ajaxService.startTransform($scope.dataStorage.session, ids).then(function(response) {\r\n                $scope.reload.torrent();\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"开始传输任务请求失败！\",\r\n                    content:\"请检查您的网络是否顺畅！\",\r\n                    btnType : 1\r\n                });\r\n            });\r\n        };\r\n\r\n        $scope.startTransformNow = function(ids) {\r\n            if (validationIDS(ids) === false) {\r\n                return false;\r\n            }\r\n            ajaxService.startTransformNow($scope.dataStorage.session, ids).then(function(response) {\r\n                $scope.reload.torrent();\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"立即开始传输任务请求失败！\",\r\n                    content:\"请检查您的网络是否顺畅！\",\r\n                    size:\"small\",\r\n                    btnType : 1\r\n                });\r\n            });\r\n        };\r\n\r\n        $scope.submitSettings = function (params) {\r\n            ajaxService.saveSettings($scope.dataStorage.session, params).then(function(response) {\r\n                $scope.dataStorage.globalOrignal = {};\r\n                $scope.modal.status = false;\r\n                $scope.getStatsData();\r\n                $scope.reload.session();\r\n            }, function(reason) {\r\n                $scope.modal.show({\r\n                    type:\"waring\",\r\n                    title:\"保存设置失败！\",\r\n                    content:\"请检查您的网络是否顺畅，或点击确定再此尝试保存！\",\r\n                    size:\"small\",\r\n                    btnType : 2,\r\n                    submitFunc:function () {\r\n                        $scope.submitSettings(params);\r\n                    }\r\n                });\r\n            });\r\n        };\r\n\r\n        $scope.consolePanel = {\r\n            status: false,\r\n            show: function() {\r\n                $scope.consolePanel.status = true;\r\n            },\r\n            close: function() {\r\n                $scope.consolePanel.status = false;\r\n            }\r\n        };\r\n\r\n        $scope.modal = {\r\n            \"status\":false,\r\n            \"isNeedTitle\":false,\r\n            \"type\":\"add\",//tip,waring,delete,add,window\r\n            \"size\":\"small\",\r\n            \"title\":\"添加传输任务失败\",\r\n            \"content\":\"请检查你的网络，或者尝试重新添加一次！\",\r\n            \"btnType\":2,//0 只有确定按钮，1 只有取消按钮，2 两个都有\r\n            \"tmp\":$scope.tmpUrl.modal,\r\n            \"btnText\":{\r\n                \"submit\":\"确定\",\r\n                \"cancel\":\"关闭\"\r\n            },\r\n            \"submitFunc\":function () {\r\n                $scope.modal.close();\r\n            },\r\n            \"show\":function (op) {\r\n                if(op !== undefined && op.$event!==null && op.$event!==undefined){\r\n                    op.$event.stopPropagation();\r\n                }\r\n\r\n                if($scope.modal.status === true){\r\n                    return false;\r\n                }\r\n\r\n                if(op.type === \"window\"){\r\n                    $scope.modal.size = \"window\";\r\n                }else if(op.size === undefined){\r\n                    $scope.modal.size = \"small\";\r\n                }\r\n\r\n                if(op.tmp !== undefined){\r\n                    $scope.modal.tmp = op.tmp;\r\n                }\r\n\r\n                var className = \"alpha\";\r\n\r\n                if(op !== undefined){\r\n                    _.each(op,function (value,key) {\r\n                        if(key !== \"show\" && key !== \"close\"){\r\n                            $scope.modal[key] = value;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                $scope.modal.status = $scope.modal.status !== true;\r\n\r\n                $timeout(function () {\r\n                    $(\"#modal-bg\").addClass(className);\r\n                    $(\"#modal\").addClass(className);\r\n                },100);\r\n            },\r\n            \"close\":function () {\r\n                var className = \"alpha\";\r\n\r\n                $(\"#modal-bg\").removeClass(className);\r\n                $(\"#modal\").removeClass(className);\r\n\r\n                //如果是设置页面关闭窗口，并没有保存，则重新轮询session\r\n                if($scope.modal.tmp === $scope.tmpUrl.settings){\r\n                    $scope.reload.session();\r\n                }\r\n\r\n                $timeout(function () {\r\n                    $scope.modal.status = false;\r\n                    $scope.modal.tmp = $scope.tmpUrl.modal;\r\n                },240);\r\n            },\r\n            \"selectTagContent\":function ($index) {\r\n                return $scope.tag.index === $index;\r\n            }\r\n        };\r\n\r\n        $scope.tag = {\r\n            \"name\":[\"种子\",\"速度\",\"用户\",\"网络\"],\r\n            \"index\":0,\r\n            \"swipLeft\":function () {\r\n                if($scope.tag.index < 3 && $scope.getScreenWidth() <= 1024){\r\n                    $scope.tag.index += 1;\r\n                }\r\n            },\r\n            \"swipRight\":function () {\r\n                if($scope.tag.index > 0 && $scope.getScreenWidth() <= 1024){\r\n                    $scope.tag.index -= 1;\r\n                }\r\n            },\r\n            \"toggle\":function ($index) {\r\n                // var contents = $(\"#modal .tag-content\");\r\n                $scope.tag.index = $index;\r\n                // contents.eq($index).addClass(\"selected\").siblings().removeClass(\"selected\");\r\n            }\r\n        };\r\n\r\n        $scope.nav = {\r\n            status:false,\r\n            menudata:{\r\n                name:[\"设置\",\"计划任务运行\",\"收缩视图\",\"查看传输明细\",\"统计\",\"关于\"],\r\n                className:[\"icon-settings\",\"icon-scheduled\",\"icon-listview\",\"icon-info-black\",\"icon-data_usage\",\"icon-goat\"]\r\n            },\r\n            toggle:function () {\r\n                if($scope.allLoaded === false){\r\n                    return false;\r\n                }\r\n                $scope.nav.status = $scope.nav.status !== true;\r\n            },\r\n            show:function () {\r\n                $scope.nav.status = true;\r\n            },\r\n            close:function ($event,index) {\r\n                if($event){\r\n                    $event.stopPropagation();\r\n                }\r\n\r\n                $scope.nav.status = false;\r\n\r\n                switch (index){\r\n                    case 0:\r\n                        clearInterval($scope.pool.loop.session);\r\n                        ajaxService.portTest($scope.dataStorage.session).then(function (response) {\r\n                            $scope.dataStorage[\"port-test\"] = response.data[\"arguments\"][\"port-is-open\"];\r\n                        },function (reason) {\r\n                            $scope.modal.show({\r\n                                type:\"waring\",\r\n                                title:\"端口是否开启检测失败\",\r\n                                content:\"请检查您的网络是否顺畅！\",\r\n                                btnType : 1\r\n                            });\r\n                        });\r\n                        $scope.modal.show({\r\n                            type:\"window\",\r\n                            tmp:$scope.tmpUrl.settings,\r\n                            btnType : 2,\r\n                            submitFunc : function () {\r\n                                var param = {};\r\n                                _.each($scope.dataStorage.global,function (value,key) {\r\n                                    if(value !== $scope.dataStorage.globalOrignal[key]){\r\n                                        param[key] = value;\r\n                                    }\r\n                                });\r\n                                $scope.submitSettings(param);\r\n                            }\r\n                        });\r\n                        break;\r\n                    case 1:\r\n                        var params = {\"alt-speed-enabled\":$scope.dataStorage.global[\"alt-speed-enabled\"] !== true};\r\n                        ajaxService.saveSettings($scope.dataStorage.session, params).then(function(response) {\r\n                            $scope.reload.session();\r\n                        }, function(reason) {\r\n                            $scope.modal.show({\r\n                                type:\"waring\",\r\n                                title:(params[\"alt-speed-enabled\"] === true?\"打开\":\"关闭\") + \"计划任务失败！\",\r\n                                content:\"请检查您的网络是否顺畅，或点击确定再此尝试保存！\",\r\n                                btnType : 1\r\n                            });\r\n                        });\r\n                        break;\r\n                    case 3:\r\n                        $scope.detail.show();\r\n                        break;\r\n                    case 4:\r\n                        $scope.modal.show({\r\n                            type:\"tip\",\r\n                            tmp:$scope.tmpUrl.statics,\r\n                            btnType : 1\r\n                        });\r\n                        break;\r\n                    case 5:\r\n                        $scope.modal.show({\r\n                            type:\"tip\",\r\n                            tmp:$scope.tmpUrl.about,\r\n                            btnType : 1\r\n                        });\r\n                        break;\r\n                }\r\n            },\r\n            parseMenuVisible:function ($index) {\r\n                return ($index < 3);\r\n            }\r\n        };\r\n\r\n        $scope.getTotalSpeed = function () {\r\n            var result = {\r\n                download:0,\r\n                upload:0\r\n            };\r\n\r\n            _.each($scope.dataStorage.torrent,function (obj,index) {\r\n                result.download += (obj.rateDownload === undefined || obj.rateDownload === null) ? 0 :obj.rateDownload;\r\n                result.upload += (obj.rateUpload === undefined || obj.rateUpload === null) ? 0 :obj.rateUpload;\r\n            });\r\n\r\n            $scope.dataStorage.totalSpeed.download = result.download;\r\n            $scope.dataStorage.totalSpeed.upload = result.upload;\r\n        };\r\n\r\n        $scope.getScreenWidth = function () {\r\n            return $(window).width();\r\n        };\r\n\r\n        $scope.stopAllAjax = function () {\r\n            _.each($scope.pool.loop,function (value,key) {\r\n                clearInterval($scope.pool.loop[key]);\r\n            });\r\n            _.each($scope.pool.ajax,function (value,key) {\r\n                $scope.closeAjax($scope.pool.ajax[key]);\r\n            });\r\n        };\r\n\r\n        $scope.init = function() {\r\n\r\n            // if($scope.getScreenWidth() >= 1024){\r\n                // var doc = window.document;\r\n                // var docEl = doc.documentElement;\r\n                //\r\n                // var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;\r\n                // var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;\r\n                //\r\n                // if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {\r\n                //     requestFullScreen.call(docEl);\r\n                // }\r\n                // else {\r\n                //     cancelFullScreen.call(doc);\r\n                // }\r\n            // }\r\n\r\n            //load local data\r\n            $scope.localMode = false;\r\n\r\n            if ($scope.localMode === true) {\r\n                var deferred = $q.defer();\r\n\r\n                require([\"localData\"], function(localData) {\r\n                    deferred.resolve(localData);\r\n                });\r\n\r\n                deferred.promise.then(function(response) {\r\n                    $scope.dataStorage = {\r\n                        global: response.global,\r\n                        torrent: response.torrent,\r\n                        selectedIndex: response.selectedIndex,\r\n                        stats: response.stats,\r\n                        ids: response.ids,\r\n                        detail: response.detail\r\n                    };\r\n\r\n                    $scope.getTotalSpeed();\r\n                }, function(reason) {\r\n\r\n                });\r\n            }\r\n\r\n            //连续获取seesion\r\n            $scope.pool.loop.session = setInterval(function() {\r\n                $scope.getSession();\r\n            }, 3000);\r\n\r\n            //获取到session后结束循环获取session\r\n            $scope.$on(\"getSessionDone\", function(event) {\r\n                clearInterval($scope.pool.loop.session);\r\n                //获取总的下载和上传速度\r\n                $scope.getStatsData(\"init\");\r\n\r\n                //轮询session数据，以避免丢失session\r\n                $scope.loopGetSession();\r\n            });\r\n\r\n            $scope.$on(\"getStatsDone\", function() {\r\n                $scope.loopGetTorrentData();\r\n            });\r\n\r\n            $scope.allLoaded = false;\r\n            //\r\n            document.addEventListener('touchstart', function(event) {\r\n                // 判断默认行为是否可以被禁用\r\n                if (event.cancelable) {\r\n                    // 判断默认行为是否已经被禁用\r\n                    if (!event.defaultPrevented) {\r\n                        event.preventDefault();\r\n                    }\r\n                }\r\n            }, false);\r\n\r\n            // $scope.modal.show({\r\n            //     type:\"waring\",\r\n            //     title:\"一分钟内请求Session失败次数过多\",\r\n            //     content:\"请检查您的网络是否顺畅，或点击确定通过刷新尝试解决！\",\r\n            //     size:\"big\",\r\n            //     btnType : 2,\r\n            //     submitFunc : function () {\r\n            //         $window.location.reload();\r\n            //     }\r\n            // });\r\n            // $scope.modal.show({\r\n            //     type:\"window\",\r\n            //     btnType : 2,\r\n            //     submitFunc : function () {\r\n            //         // $window.location.reload();\r\n            //     }\r\n            // });\r\n        };\r\n\r\n        $scope.init();\r\n\r\n    }]);\r\n\r\n    //inlclude 直接用被嵌套的HTML替换include所在的标签\r\n    $app.directive('includeReplace', function() {\r\n        return {\r\n            require: 'ngInclude',\r\n            restrict: 'A',\r\n            /* optional */\r\n            link: function(scope, el, attrs) {\r\n                el.replaceWith(el.children());\r\n            }\r\n        };\r\n    });\r\n\r\n    return $app;\r\n});\r\n"]}